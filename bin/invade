#!/usr/bin/env sh

echo "Creating backup directories..."
[ ! -d "$HOME/backups" ] && mkdir "$HOME/backups"
[ ! -d "$HOME/backups/vim_backups" ] && mkdir "$HOME/backups/vim_backups"

cd
echo "Moving existing files to ~/backups and invading..."
for rcfile in $(find dotfiles -name "*rc" -and ! -ipath "*x11*") "dotfiles/vim" "dotfiles/mutt"; do
    base=`basename $rcfile`
    timestamp=`date +%s`

    if [ -e .$base ]; then
        mv .$base ~/backups/$base.$timestamp
        ln -s $rcfile .$base
    fi
done

echo "Creating local config files..."
touch dotfiles/bash/local
touch dotfiles/vim/local.vim

echo "Done !"
